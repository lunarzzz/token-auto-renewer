<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Token Auto Renewer</title>
  <link rel="stylesheet" href="popup.css">
</head>

<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <div class="header-icon">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 2L2 7l10 5 10-5-10-5z" fill="url(#grad1)" opacity="0.9" />
          <path d="M2 17l10 5 10-5" stroke="url(#grad2)" stroke-width="2" fill="none" stroke-linecap="round" />
          <path d="M2 12l10 5 10-5" stroke="url(#grad2)" stroke-width="2" fill="none" stroke-linecap="round" />
          <defs>
            <linearGradient id="grad1" x1="2" y1="2" x2="22" y2="12">
              <stop offset="0%" stop-color="#6366f1" />
              <stop offset="100%" stop-color="#8b5cf6" />
            </linearGradient>
            <linearGradient id="grad2" x1="2" y1="12" x2="22" y2="22">
              <stop offset="0%" stop-color="#8b5cf6" />
              <stop offset="100%" stop-color="#a78bfa" />
            </linearGradient>
          </defs>
        </svg>
      </div>
      <div>
        <h1 class="header-title">Token Auto Renewer</h1>
        <p class="header-subtitle">多服务 · 多账号 · 自动续期</p>
      </div>
    </header>

    <!-- Account List -->
    <div id="accountList"></div>

    <!-- Add Account Button -->
    <button id="addAccountBtn" class="btn btn-add">
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
        <line x1="12" y1="5" x2="12" y2="19" />
        <line x1="5" y1="12" x2="19" y2="12" />
      </svg>
      添加账号
    </button>

    <!-- Global Actions -->
    <div class="actions">
      <button id="renewAllBtn" class="btn btn-primary">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <polyline points="23 4 23 10 17 10" />
          <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10" />
        </svg>
        全部续期
      </button>
    </div>
    <div class="actions">
      <button id="exportBtn" class="btn btn-secondary">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
          <polyline points="7 10 12 15 17 10" />
          <line x1="12" y1="15" x2="12" y2="3" />
        </svg>
        导出配置
      </button>
      <button id="importBtn" class="btn btn-secondary">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
          <polyline points="17 8 12 3 7 8" />
          <line x1="12" y1="3" x2="12" y2="15" />
        </svg>
        导入配置
      </button>
      <input type="file" id="importFileInput" accept=".json" style="display:none">
    </div>

    <!-- Logs -->
    <div class="card logs-card">
      <div class="card-header">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
          <polyline points="14 2 14 8 20 8" />
          <line x1="16" y1="13" x2="8" y2="13" />
          <line x1="16" y1="17" x2="8" y2="17" />
          <polyline points="10 9 9 9 8 9" />
        </svg>
        <span>运行日志</span>
        <button id="clearLogsBtn" class="btn-icon" title="清除日志">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6" />
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
          </svg>
        </button>
      </div>
      <div class="logs-container" id="logsContainer">
        <div class="log-empty">暂无日志</div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <span>Token Auto Renewer v3.0</span>
    </footer>
  </div>

  <!-- Account Edit Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <div class="modal-header">
        <h2 id="modalTitle">添加账号</h2>
        <button class="btn-icon modal-close" id="modalCloseBtn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18" />
            <line x1="6" y1="6" x2="18" y2="18" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <input type="hidden" id="editAccountId">
        <div class="form-group">
          <label for="editLoginType">登录类型</label>
          <select id="editLoginType">
            <option value="dubbo">Dubbo Admin</option>
            <option value="kibana">ES Kibana</option>
          </select>
        </div>
        <div class="form-group">
          <label for="editAlias">别名</label>
          <input type="text" id="editAlias" placeholder="如：生产环境 / 测试环境" spellcheck="false">
        </div>
        <div class="form-group">
          <label for="editAdminUrl">服务地址</label>
          <input type="url" id="editAdminUrl" placeholder="https://your-admin.com" spellcheck="false">
        </div>
        <div class="form-group kibana-only" id="kbnVersionGroup" style="display:none">
          <label for="editKbnVersion">Kibana Version</label>
          <input type="text" id="editKbnVersion" placeholder="7.10.2" value="7.10.2" spellcheck="false">
        </div>
        <div class="form-group">
          <label for="editUserName">用户名</label>
          <input type="text" id="editUserName" placeholder="admin" spellcheck="false">
        </div>
        <div class="form-group">
          <label for="editPassword">密码</label>
          <div class="password-wrapper">
            <input type="password" id="editPassword" placeholder="请输入密码" spellcheck="false">
            <button type="button" class="toggle-password" id="togglePassword" title="显示/隐藏密码">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                id="eyeIcon">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                <circle cx="12" cy="12" r="3" />
              </svg>
            </button>
          </div>
        </div>
        <div class="form-group">
          <label for="editInterval">续期间隔 (分钟)</label>
          <input type="number" id="editInterval" min="1" max="120" value="25">
        </div>
        <div class="form-group toggle-group">
          <label for="editEnabled">启用自动续期</label>
          <label class="toggle">
            <input type="checkbox" id="editEnabled" checked>
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button id="modalCancelBtn" class="btn btn-secondary">取消</button>
        <button id="modalSaveBtn" class="btn btn-primary">保存</button>
      </div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>

</html>